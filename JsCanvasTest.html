<html>
<head>
<title>LOL</title>
<script type="text/javascript">
	
	
	var boats = [];
	window.onload=function () {
		function Boat(xinit,yinit) {
			this.x=xinit;
			this.y=yinit;
			this.xdest = null;
			this.ydest = null;
			this.speed=20;
			this.thrust=1;
			this.mass=2;
			this.heading=180;
			this.turnrate = 5
			this.dt=0.1
			this.rgb = [Math.floor((Math.random() * 50) + 1),Math.floor((Math.random() * 50) + 1),Math.floor((Math.random() * 50) + 1)]
			this.target = null
			
			this.updatePos=function() {
				this.x = this.x + Math.cos(this.heading * Math.PI/180) * this.speed * this.dt;
				this.y = this.y - Math.sin(this.heading * Math.PI/180) * this.speed * this.dt;
			}
			
			this.setTarget=function(tar){
				this.target = tar
				this.setdest(tar.x,tar.y)
				var c=document.getElementById("tutorial");
				var ctx=c.getContext("2d");
				ctx.beginPath();
				ctx.moveTo(this.x,this.y);
				ctx.lineTo(this.xdest,this.ydest);
				ctx.stroke();
			}
			
			this.updateTarget=function(){
				if (this.target == null) {
					lol=1 //do nothing
				} else {
					this.setdest(this.target.x,this.target.y)
				}
				var c=document.getElementById("tutorial");
				var ctx=c.getContext("2d");
				ctx.beginPath();
				ctx.moveTo(this.x,this.y);
				ctx.lineTo(this.target.xdest,this.target.ydest);
				ctx.stroke();
			}
			
			this.turn=function() {
				if (this.xdest == null){ 
					lol=1;
				} else {
					if (this.y < this.ydest){
						var myvar = 180;
					} else {
						var myvar = 0;
					}
					var bearing = (Math.atan((this.x - this.xdest) / (this.y - this.ydest )) * 180 / Math.PI)+90 + myvar;

					var dir = bearing - this.heading;
					if (dir > 180){
						if (dir < 0){
							this.heading += this.turnrate;} 
							else{
							this.heading -= this.turnrate;
						}
					} else if (dir < 0){ 
						if (this.heading > 180){
							this.heading -= this.turnrate;
						} else {
						this.heading -= this.turnrate;
					}
					}  else {
						this.heading += this.turnrate;
					}
				}
				this.heading = this.heading % 360;
				if (this.heading <= 0) {this.heading += 360}
				
			}
			
			this.setdest=function(x,y){
				this.xdest = x;
				this.ydest = y;
			}
			
			this.updateVel=function() {
				this.speed = this.speed * .99;
			}
			
			this.acc=function() {
				this.speed += this.thrust/this.mass;
			}
			
			this.draw=function(ctx){
				//ctx.clearRect(0, 0, 800, 800);
				ctx.fillStyle = "rgba("+this.rgb[0]+", "+this.rgb[1]+", "+this.rgb[2]+", 0.5)";
				ctx.fillRect (this.x, this.y, 10, 10);
			}
			
			
		}

		function TestBoat(){
			var canvas = document.getElementById('tutorial');
			var context = canvas.getContext("2d");
			var maxx=1000
			var maxy=1000
			var numboats = 30
			
			for (var i = 0; i < numboats; i++) { 
				boats[i] = new Boat(Math.floor((Math.random() * maxx) + 1),Math.floor((Math.random() * maxy) + 1));
			}
			for (var j = 1; j < boats.length; j++) {
				boats[j].setTarget(boats[j-1])
				//var x = boats[j];
				//var y = boats[j-1];
				//x.setTarget(y);
			} 	
			
			var count = 0;
			
			var moveInterval = setInterval(function(){
				context.clearRect(0, 0, 1500, 1500);
				for (var i = 1; i < numboats; i++) {
					
					boats[i].acc()
					boats[i].updateVel();
					boats[i].draw(context);
					boats[i].updateTarget();
					
					boats[i].turn();
					boats[i].updatePos();
					
				} 
				count += 1
				
			}, 50);
			
		}
		TestBoat();
	}

	
</script>
</head>
<body>
	<div id="title">
		
<!--
	<h1>Title Goes here</h1>
	Heading:
	<p id="p1">Hello World!</p>
	Bearing to dest:
	<p id="p2">Hello World!</p>
	Boat Pos:
	<p id="p3">Hello World!</p>
	Target Pos:
	<p id="p4">Hello World!</p>
	AA
	<p id="p5">Hello World!</p>
-->
	
	</div>
	<hr>
	<canvas id="tutorial" width="1500" height="800"></canvas>
</body>
</html>
